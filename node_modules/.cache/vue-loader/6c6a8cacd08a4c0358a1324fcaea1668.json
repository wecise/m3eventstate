{"remainingRequest":"/Users/cnwangzd/Documents/cnwangzd/wecise/m3/apps/m3search/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/cnwangzd/Documents/cnwangzd/wecise/m3/apps/m3search/src/components/search/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/cnwangzd/Documents/cnwangzd/wecise/m3/apps/m3search/src/components/search/index.vue","mtime":1630203502586},{"path":"/Users/cnwangzd/Documents/cnwangzd/wecise/m3/apps/m3search/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/cnwangzd/Documents/cnwangzd/wecise/m3/apps/m3search/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/cnwangzd/Documents/cnwangzd/wecise/m3/apps/m3search/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/cnwangzd/Documents/cnwangzd/wecise/m3/apps/m3search/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBfIGZyb20gJ2xvZGFzaCc7CmltcG9ydCAkIGZyb20gJ2pxdWVyeSc7CmltcG9ydCBldmVudCBmcm9tICcuL2V2ZW50LnZ1ZSc7CmltcG9ydCBjaGFuZ2UgZnJvbSAnLi9jaGFuZ2UudnVlJzsKaW1wb3J0IGVudGl0eSBmcm9tICcuL2VudGl0eS52dWUnOwppbXBvcnQgZmlsZSBmcm9tICcuL2ZpbGUudnVlJzsKaW1wb3J0IHBlcmYgZnJvbSAnLi9wZXJmLnZ1ZSc7CmltcG9ydCB0aW1lbGluZSBmcm9tICcuL3RpbWVsaW5lLnZ1ZSc7CgpleHBvcnQgZGVmYXVsdCB7CiAgICBuYW1lOiAiSW5kZXhWaWV3IiwKICAgIGNvbXBvbmVudHM6ewogICAgICAgIGV2ZW50LAogICAgICAgIGVudGl0eSwKICAgICAgICBjaGFuZ2UsCiAgICAgICAgZmlsZSwKICAgICAgICBwZXJmLAogICAgICAgIHRpbWVsaW5lCiAgICB9LAogICAgcHJvcHM6ewogICAgICAgIGdsb2JhbDogT2JqZWN0CiAgICB9LAogICAgZGF0YSgpewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIHNlYXJjaDp7CiAgICAgICAgICAgICAgICB0ZXJtOiAiIiwKICAgICAgICAgICAgICAgIGNsYXNzOiB7CiAgICAgICAgICAgICAgICAgICAgdmFsdWU6ICIvbWF0cml4L2Rldm9wcy9hbGVydF9zdGF0dXMiCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgcmVzdWx0OiBudWxsLAogICAgICAgICAgICAgICAgbG9hZGluZzogZmFsc2UKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0sCiAgICB3YXRjaDp7CiAgICAgICAgInNlYXJjaC50ZXJtIih2YWwpewogICAgICAgICAgICBpZih2YWwpewogICAgICAgICAgICAgICAgdGhpcy5vbkNsZWFyKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9LAogICAgY3JlYXRlZCgpewogICAgICAgIC8vIOWIneWni+WMlnByZXNldAogICAgICAgIC8qIHRyeXsKICAgICAgICAgICAgbGV0IHByZXNldCA9IGRlY29kZVVSSUNvbXBvbmVudCh3aW5kb3cuYXRvYih0aGlzLmdldFF1ZXJ5VmFyaWFibGUoJ3ByZXNldCcpKSk7CiAgICAgICAgICAgIF8uZXh0ZW5kKHRoaXMub3B0aW9ucyxfLmF0dGVtcHQoSlNPTi5wYXJzZS5iaW5kKG51bGwsIHByZXNldCkpKTsKICAgICAgICB9IGNhdGNoKGVycil7CiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTsKICAgICAgICB9ICovCgogICAgICAgIGRvY3VtZW50Lm9ua2V5ZG93biA9ICgpPT4gewogICAgICAgICAgICBsZXQga2V5ID0gd2luZG93LmV2ZW50LmtleUNvZGU7CiAgICAgICAgICAgIGlmIChrZXkgPT0gMTMpIHsKICAgICAgICAgICAgICAgIHRoaXMub25TZWFyY2goKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICB9LAogICAgbW91bnRlZCgpewogICAgICAgIAogICAgICAgIHRoaXMud2VjbG9tZSgpOwoKICAgIH0sCiAgICBtZXRob2RzOiB7CiAgICAgICAgb25DbGVhcigpewogICAgICAgICAgICB0aGlzLnNlYXJjaC5yZXN1bHQgPSBudWxsOwogICAgICAgIH0sCiAgICAgICAgb25TZWFyY2goKXsKCiAgICAgICAgICAgIGlmKF8uaXNFbXB0eSh0aGlzLnNlYXJjaC50ZXJtKSl7CiAgICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlLmluZm8oIuivt+i+k+WFpeaQnOe0ouWFs+mUruWtlyIpOwogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CgogICAgICAgICAgICB0aGlzLnNlYXJjaC5sb2FkaW5nID0gdHJ1ZTsKICAgICAgICAgICAgbGV0IHBhcmFtID0gZW5jb2RlVVJJQ29tcG9uZW50KCBKU09OLnN0cmluZ2lmeSgge3Rlcm06dGhpcy5zZWFyY2gudGVybSwgcHJlc2V0Om51bGx9ICkgKTsKICAgICAgICAgICAgdGhpcy5tMy5jYWxsRlMoIi9tYXRyaXgvbTNzZWFyY2gvc2VhcmNoQnlUZXJtLmpzIiwgcGFyYW0pLnRoZW4ocmVzPT57CiAgICAgICAgICAgICAgICB0aGlzLnNlYXJjaC5yZXN1bHQgPSByZXMubWVzc2FnZTsKICAgICAgICAgICAgICAgIHRoaXMuc2VhcmNoLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgfSkuY2F0Y2goZXJyPT57CiAgICAgICAgICAgICAgICB0aGlzLnNlYXJjaC5sb2FkaW5nID0gZmFsc2U7CiAgICAgICAgICAgIH0pCiAgICAgICAgfSwKICAgICAgICBnZXRRdWVyeVZhcmlhYmxlKHZhcmlhYmxlKXsKICAgICAgICAgICAgdmFyIHF1ZXJ5ID0gd2luZG93LmxvY2F0aW9uLnNlYXJjaC5zdWJzdHJpbmcoMSk7CiAgICAgICAgICAgIHZhciB2YXJzID0gcXVlcnkuc3BsaXQoIiYiKTsKICAgICAgICAgICAgZm9yICh2YXIgaT0wO2k8dmFycy5sZW5ndGg7aSsrKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIHBhaXIgPSB2YXJzW2ldLnNwbGl0KCI9Iik7CiAgICAgICAgICAgICAgICAgICAgaWYocGFpclswXSA9PSB2YXJpYWJsZSl7cmV0dXJuIHBhaXJbMV07fQogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybihmYWxzZSk7CiAgICAgICAgfSwKICAgICAgICB3ZWNsb21lKCl7CgogICAgICAgICAgICB0aGlzLm0zLmNhbGxGUygiL21hdHJpeC9tM3NlYXJjaC93ZWNsb21lLmpzIixudWxsKS50aGVuKCAocnRuKT0+ewogICAgICAgICAgICAgICAgbGV0IG1lc3NhZ2UgPSBydG4ubWVzc2FnZTsKCiAgICAgICAgICAgICAgICB0aGlzLiRub3RpZnkoewogICAgICAgICAgICAgICAgICAgIHRpdGxlOiAn5qyi6L+O5L2/55So5LiA6ZSu5pCc57SiJywKICAgICAgICAgICAgICAgICAgICB0eXBlOiAnc3VjY2VzcycsCiAgICAgICAgICAgICAgICAgICAgZGFuZ2Vyb3VzbHlVc2VIVE1MU3RyaW5nOiB0cnVlLAogICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2UKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9ICk7CiAgICAgICAgfQogICAgfQp9Cg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/components/search","sourcesContent":["<template>\n    \n    <el-container style=\"height: calc(100vh - 80px);background:#ffffff;\">\n        <el-header style=\"line-height: 60px;\">\n            <el-input placeholder=\"请输入关键字\" v-model=\"search.term\" \n                clearable\n                @clear=\"onClear\"\n                @keyup.enter=\"onSearch\">\n                <el-button slot=\"append\" icon=\"el-icon-search\" @click=\"onSearch\" :loading=\"search.loading\"></el-button>\n            </el-input>\n        </el-header>\n        <el-main style=\"overflow: hidden;height: 100%;padding-top:0px;\" v-if=\"search.result && search.result.all.length>0\">\n            <div style=\"width:100%;\">\n                <span>搜索结果：</span>\n                <template v-for=\"(v,k) in search.result\">\n                    <el-button type=\"default\" :key=\"k\" v-if=\"v.title && v.rows.length > 0\">\n                        {{v.title}}: {{v.rows.length}}\n                    </el-button>\n                </template>\n            </div>\n            <el-container style=\"height: 100%;\">\n                <el-main style=\"padding:0px;height:100%;overflow:auto;\">\n                    <el-tabs value=\"view\">\n                        <el-tab-pane name=\"view\" key=\"view\">\n                            <span slot=\"label\">按分类</span>\n                            <template v-for=\"(v,k) in search.result\">\n                                <component v-bind:is=\"k\" :dt=\"v\" :key=\"k\" v-if=\"v.title && v.rows.length>0\"></component>\n                            </template>\n                        </el-tab-pane>\n                        <el-tab-pane name=\"timeline\" key=\"timeline\">\n                            <template slot=\"label\">时间线</template>\n                            <timeline :model=\"search.result\" :global=\"global\"></timeline>\n                        </el-tab-pane>\n                    </el-tabs> \n                    \n                </el-main>\n                \n            </el-container>\n            \n        </el-main>\n\n        <el-main style=\"background:#ffffff;\" v-else>\n                <svg-icon icon-class=\"eventList\" style=\"font-size:64px;\"/>\n                <h2>没有找到相关记录。</h2>\n                <p>\n                    温馨提示：  \n                    请检查您的输入是否正确 \n                    如有任何意见或建议，请及时反馈给我们。wj@wecise.com \n                </p>\n        </el-main>\n\n    </el-container>\n    \n</template>\n\n<script>\nimport _ from 'lodash';\nimport $ from 'jquery';\nimport event from './event.vue';\nimport change from './change.vue';\nimport entity from './entity.vue';\nimport file from './file.vue';\nimport perf from './perf.vue';\nimport timeline from './timeline.vue';\n\nexport default {\n    name: \"IndexView\",\n    components:{\n        event,\n        entity,\n        change,\n        file,\n        perf,\n        timeline\n    },\n    props:{\n        global: Object\n    },\n    data(){\n        return {\n            search:{\n                term: \"\",\n                class: {\n                    value: \"/matrix/devops/alert_status\"\n                },\n                result: null,\n                loading: false\n            }\n        }\n    },\n    watch:{\n        \"search.term\"(val){\n            if(val){\n                this.onClear();\n            }\n        }\n    },\n    created(){\n        // 初始化preset\n        /* try{\n            let preset = decodeURIComponent(window.atob(this.getQueryVariable('preset')));\n            _.extend(this.options,_.attempt(JSON.parse.bind(null, preset)));\n        } catch(err){\n            console.error(err);\n        } */\n\n        document.onkeydown = ()=> {\n            let key = window.event.keyCode;\n            if (key == 13) {\n                this.onSearch();\n            }\n        }\n\n    },\n    mounted(){\n        \n        this.weclome();\n\n    },\n    methods: {\n        onClear(){\n            this.search.result = null;\n        },\n        onSearch(){\n\n            if(_.isEmpty(this.search.term)){\n                this.$message.info(\"请输入搜索关键字\");\n                return false;\n            }\n\n            this.search.loading = true;\n            let param = encodeURIComponent( JSON.stringify( {term:this.search.term, preset:null} ) );\n            this.m3.callFS(\"/matrix/m3search/searchByTerm.js\", param).then(res=>{\n                this.search.result = res.message;\n                this.search.loading = false;\n            }).catch(err=>{\n                this.search.loading = false;\n            })\n        },\n        getQueryVariable(variable){\n            var query = window.location.search.substring(1);\n            var vars = query.split(\"&\");\n            for (var i=0;i<vars.length;i++) {\n                    var pair = vars[i].split(\"=\");\n                    if(pair[0] == variable){return pair[1];}\n            }\n            return(false);\n        },\n        weclome(){\n\n            this.m3.callFS(\"/matrix/m3search/weclome.js\",null).then( (rtn)=>{\n                let message = rtn.message;\n\n                this.$notify({\n                    title: '欢迎使用一键搜索',\n                    type: 'success',\n                    dangerouslyUseHTMLString: true,\n                    message: message\n                });\n            } );\n        }\n    }\n}\n</script>\n\n<style scoped>\n\n</style>\n"]}]}